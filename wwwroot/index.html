<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Notes</title>
	<style>
		body { font-family: -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 2rem; max-width: 800px; }
		h1 { margin-bottom: 1rem; }
		form { display: grid; gap: .5rem; margin-bottom: 1.5rem; }
		input, textarea, button { font: inherit; padding: .6rem .8rem; border: 1px solid #ccc; border-radius: .4rem; }
		button { background: #0a7; color: white; border: none; cursor: pointer; }
		button:hover { background: #086; }
		.note { border: 1px solid #e3e3e3; border-radius: .6rem; padding: .8rem 1rem; margin-bottom: .8rem; }
		.note h3 { margin: 0 0 .25rem; }
		.row { display: flex; justify-content: space-between; gap: .5rem; align-items: center; }
		.meta { color: #666; font-size: .9rem; }
		.empty { color: #666; font-style: italic; }
	</style>
	<script>
		async function loadNotes() {
			const res = await fetch('/api/notes');
			const notes = await res.json();
			const list = document.getElementById('list');
			list.innerHTML = '';
			if (!notes.length) {
				list.innerHTML = '<div class=\"empty\">No notes yet. Add one!</div>';
				return;
			}
			for (const note of notes) {
				const div = document.createElement('div');
				div.className = 'note';
				const created = new Date(note.createdAt).toLocaleString();
				div.innerHTML = `
					<div class="row">
						<div>
							<h3>${escapeHtml(note.title)}</h3>
							<div class="meta">${created}</div>
						</div>
						<div>
							<button onclick="deleteNote('${note.id}')">Delete</button>
						</div>
					</div>
					<p>${escapeHtml(note.content).replace(/\\n/g, '<br>')}</p>
				`;
				list.appendChild(div);
			}
		}
		async function deleteNote(id) {
			await fetch('/api/notes/' + id, { method: 'DELETE' });
			await loadNotes();
		}
		function escapeHtml(str) {
			return (str || '').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'}[m]));
		}
		window.addEventListener('DOMContentLoaded', () => {
			document.getElementById('form').addEventListener('submit', async (e) => {
				e.preventDefault();
				const title = document.getElementById('title').value.trim();
				const content = document.getElementById('content').value.trim();
				if (!title) { alert('Title is required'); return; }
				await fetch('/api/notes', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({ title, content })
				});
				e.target.reset();
				await loadNotes();
			});
			loadNotes();
		});
	</script>
	</head>
<body>
	<h1>Notes</h1>
	<form id="form">
		<input id="title" placeholder="Title" required>
		<textarea id="content" placeholder="Content" rows="4"></textarea>
		<button type="submit">Add Note</button>
	</form>
	<div id="list"></div>
</body>
</html>


